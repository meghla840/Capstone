<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Join – QuickAid</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<style>
:root{
    --brand:#49465b;
    --header-gradient: linear-gradient(90deg, #49465b, #6e6c80);
    --accent:#2563eb;
    --bg:#f3f6f9;
    --card:#ffffff;
    --muted:#6b7280;
}
body {
    font-family: 'Inter', sans-serif;
    background: var(--bg);
    margin:0;
    padding:0;
    color:#0f172a;
}
header {
    background: var(--header-gradient);
    color: white;
    padding: 1rem 1.5rem;
    display:flex;
    justify-content:center;
    align-items:center;
    position: sticky;
    top:0;
    z-index:1000;
}
header i {
    font-size: 1.4rem;
    cursor: pointer;
    position:absolute;
    left:20px;
}
header h1 {
    margin:0;
    font-size:1.4rem;
    font-weight:600;
    text-align:center;
    width:100%;
}
.card {
    max-width:650px;
    margin:2rem auto;
    background:var(--card);
    padding:2rem 2.5rem;
    border-radius:15px;
    box-shadow:0 8px 25px rgba(0,0,0,0.12);
}
h2 {
    text-align:center;
    font-size:2rem;
    color:var(--brand);
    margin-bottom:1.5rem;
}
input, select {
    width:100%;
    padding:12px;
    margin:8px 0;
    border:1px solid #e6e9ef;
    border-radius:8px;
    font-size:1rem;
    transition:0.2s;
}
input:focus, select:focus { border-color: var(--accent); outline:none; box-shadow:0 0 5px rgba(37,99,235,0.3);}

button {
    background: var(--header-gradient);
    color:white;
    width:100%;
    padding:14px;
    border:none;
    border-radius:10px;
    font-size:1.1rem;
    cursor:pointer;
    font-weight:600;
    transition:0.3s;
}
button:hover { opacity:0.9; }

.hidden { display:none; }

.login-link {
    text-align:center;
    margin-top:1rem;
}
.login-link a {
    color:var(--brand);
    font-weight:700;
    text-decoration:none;
}
.login-link a:hover { text-decoration:underline; }

/* Notification popup */
#toast {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: var(--header-gradient);
    color:white;
    padding: 12px 25px;
    border-radius: 8px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    display: none;
    font-weight:600;
    z-index:2000;
}
</style>
</head>

<body>

<header>
    <i class="bi bi-arrow-left" onclick="history.back()"></i>
    <h1>Create Account</h1>
</header>

<div class="card">
    <h2>Join QuickAid</h2>

    <form id="signupForm">

        <input type="text" id="name" placeholder="Full Name" required>
        <input type="text" id="phone" placeholder="Phone Number" required>
        <input type="email" id="email" placeholder="Email Address" required>
        <input type="password" id="password" placeholder="Create Password" required>
        <input type="password" id="confirmPassword" placeholder="Confirm Password" required>

        <label>Select Role</label>
        <select id="role" onchange="showRoleFields()" required>
            <option value="">Choose</option>
            <option value="patient">Patient</option>
            <option value="doctor">Doctor</option>
            <option value="hospital">Hospital</option>
            <option value="pharmacy">Pharmacy</option>
        </select>

        <!-- PATIENT -->
        <div id="patientFields" class="hidden">
            <label>Blood Group</label>
            <select id="bloodGroup">
                <option value="">Select Blood Group</option>
                <option>A+</option><option>A-</option>
                <option>B+</option><option>B-</option>
                <option>AB+</option><option>AB-</option>
                <option>O+</option><option>O-</option>
            </select>
            <label>Previous Health Issues</label>
            <input type="text" id="healthIssues" placeholder="e.g., Diabetes, Asthma">
            <label>Address</label>
            <input type="text" id="address" placeholder="Home / Local Address">
        </div>

        <!-- DOCTOR -->
        <div id="doctorFields" class="hidden">
            <label>Specialization</label>
            <input type="text" id="specialization" placeholder="Cardiologist, Pediatrician etc.">
            <label>BMDC Registration Number</label>
            <input type="text" id="bmdc" placeholder="Registration Number">
            <label>Clinic / Practice Address</label>
            <input type="text" id="clinic" placeholder="Clinic Address">
        </div>

        <!-- HOSPITAL -->
        <div id="hospitalFields" class="hidden">
            <label>Hospital Name</label>
            <input type="text" id="hospitalName" placeholder="Hospital Name">
            <label>License Number</label>
            <input type="text" id="licenseH" placeholder="License Number">
            <label>Emergency Contact</label>
            <input type="text" id="hphone" placeholder="Emergency Phone">
        </div>

        <!-- PHARMACY -->
        <div id="pharmacyFields" class="hidden">
            <label>Pharmacy Name</label>
            <input type="text" id="pharmacyName" placeholder="Pharmacy Name">
            <label>Drug License Number</label>
            <input type="text" id="drugLicense" placeholder="License Number">
            <label>Address</label>
            <input type="text" id="pharmAddress" placeholder="Pharmacy Address">
        </div>

        <button type="submit">Sign Up</button>

        <div class="login-link">
            Already have an account? <a href="login.html">Login</a>
        </div>

    </form>
</div>

<div id="toast"></div>

<script>
function showRoleFields() {
    let role = document.getElementById("role").value;
    ["patient","doctor","hospital","pharmacy"].forEach(r=>{
        document.getElementById(r+"Fields").classList.add("hidden");
    });
    if(role) document.getElementById(role+"Fields").classList.remove("hidden");
}

function showToast(msg){
    const t = document.getElementById("toast");
    t.textContent = msg;
    t.style.display = "block";
    setTimeout(()=> t.style.display="none", 3000);
}

document.getElementById("signupForm").addEventListener("submit", function(e){
    e.preventDefault();

    let pass = document.getElementById("password").value;
    let confirm = document.getElementById("confirmPassword").value;

    if(pass !== confirm){
        showToast("❗ Passwords do not match!");
        return;
    }

    let role = document.getElementById("role").value;
    if(!role){
        showToast("❗ Select a role");
        return;
    }

    let email = document.getElementById("email").value.trim().toLowerCase();
    let users = JSON.parse(localStorage.getItem("quickAidUsers") || "[]");

    // Prevent duplicate patient email
    if(role==="patient" && users.some(u=>u.email===email && u.role==="patient")){
        showToast("⚠ This patient email already exists.");
        return;
    }

    let newUser = {
        id: "u_" + Date.now(),
        name: document.getElementById("name").value.trim(),
        phone: document.getElementById("phone").value.trim(),
        email: email,
        password: pass,
        role: role,
        documents: [],
        appointments: []
    };

    // Add role-specific info
    if(role==="patient"){
        newUser.bloodGroup = document.getElementById("bloodGroup").value;
        newUser.healthIssues = document.getElementById("healthIssues").value.trim();
        newUser.address = document.getElementById("address").value.trim();
    }
    if(role==="doctor"){
        newUser.specialization = document.getElementById("specialization").value.trim();
        newUser.bmdc = document.getElementById("bmdc").value.trim();
        newUser.clinic = document.getElementById("clinic").value.trim();
    }
    if(role==="hospital"){
        newUser.hospitalName = document.getElementById("hospitalName").value.trim();
        newUser.licenseH = document.getElementById("licenseH").value.trim();
        newUser.hphone = document.getElementById("hphone").value.trim();
    }
    if(role==="pharmacy"){
        newUser.pharmacyName = document.getElementById("pharmacyName").value.trim();
        newUser.drugLicense = document.getElementById("drugLicense").value.trim();
        newUser.pharmAddress = document.getElementById("pharmAddress").value.trim();
    }

    users.push(newUser);

    // Save everything
    localStorage.setItem("quickAidUsers", JSON.stringify(users));
    localStorage.setItem("quickAidCurrent", newUser.id);

    showToast("✅ Account created successfully!");

    setTimeout(()=> window.location.href="index.html", 1200);
});
</script>

</body>
</html>
